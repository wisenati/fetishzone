<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fetish Zone | Premium Store Dashboard</title>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Montserrat:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Animate.css -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />

    <style>
      :root {
        --primary: #8b5cf6;
        --primary-dark: #7c3aed;
        --secondary: #f43f5e;
        --accent: #06b6d4;
        --dark: #1e293b;
        --darker: #0f172a;
        --light: #f8fafc;
        --gray: #94a3b8;
        --gray-light: #cbd5e1;
        --gold: #f59e0b;
        --success: #10b981;
        --error: #ef4444;
        --warning: #f59e0b;
        --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        --shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 25px 50px rgba(0, 0, 0, 0.2);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Montserrat", sans-serif;
        background-color: var(--darker);
        color: var(--light);
        min-height: 100vh;
        overflow-x: hidden;
        background-image: radial-gradient(
            at 80% 0%,
            hsla(189, 100%, 56%, 0.1) 0px,
            transparent 50%
          ),
          radial-gradient(
            at 0% 50%,
            hsla(355, 100%, 93%, 0.1) 0px,
            transparent 50%
          ),
          radial-gradient(
            at 80% 100%,
            hsla(260, 100%, 70%, 0.1) 0px,
            transparent 50%
          );
      }

      /* Luxury Loader */
      .loader-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
      }

      .loader-container.hidden {
        opacity: 0;
        visibility: hidden;
      }

      .loader {
        width: 100px;
        height: 100px;
        position: relative;
        margin-bottom: 2rem;
      }

      .loader-ring {
        position: absolute;
        width: 100%;
        height: 100%;
        border: 4px solid transparent;
        border-radius: 50%;
        animation: spin 2s linear infinite;
      }

      .loader-ring:nth-child(1) {
        border-top-color: var(--primary);
        animation-delay: 0s;
      }

      .loader-ring:nth-child(2) {
        border-right-color: var(--secondary);
        animation-delay: 0.3s;
        width: 80%;
        height: 80%;
        top: 10%;
        left: 10%;
      }

      .loader-ring:nth-child(3) {
        border-bottom-color: var(--gold);
        animation-delay: 0.6s;
        width: 60%;
        height: 60%;
        top: 20%;
        left: 20%;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loader-logo {
        width: 80px;
        height: 80px;
        object-fit: contain;
        margin-bottom: 2rem;
        animation: pulse 2s infinite;
        filter: drop-shadow(0 0 20px rgba(139, 92, 246, 0.5));
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.8;
        }
      }

      .loader-text {
        font-family: "Playfair Display", serif;
        font-size: 2rem;
        font-weight: 700;
        background: linear-gradient(
          90deg,
          var(--primary),
          var(--secondary),
          var(--gold)
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-transform: uppercase;
        letter-spacing: 3px;
        animation: shimmer 3s infinite;
      }

      @keyframes shimmer {
        0% {
          background-position: -200% center;
        }
        100% {
          background-position: 200% center;
        }
      }

      .loader-subtitle {
        margin-top: 1rem;
        color: var(--gray);
        font-size: 1rem;
        letter-spacing: 1px;
        animation: fadeInOut 2s infinite;
      }

      @keyframes fadeInOut {
        0%,
        100% {
          opacity: 0.5;
        }
        50% {
          opacity: 1;
        }
      }

      /* Header */
      .header {
        position: sticky;
        top: 0;
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 1000;
        padding: 1rem 0;
        transition: var(--transition);
      }

      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo-container {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .logo {
        width: 50px;
        height: 50px;
        object-fit: contain;
        filter: drop-shadow(0 0 10px rgba(139, 92, 246, 0.5));
        transition: var(--transition);
      }

      .logo:hover {
        transform: rotate(15deg) scale(1.1);
      }

      .brand-name {
        font-family: "Playfair Display", serif;
        font-size: 1.8rem;
        font-weight: 700;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        letter-spacing: 1px;
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 1.5rem;
      }

      .search-container {
        position: relative;
        width: 300px;
      }

      .search-input {
        width: 100%;
        padding: 12px 20px 12px 50px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 25px;
        color: var(--light);
        font-size: 0.9rem;
        transition: var(--transition);
      }

      .search-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        background: rgba(255, 255, 255, 0.15);
      }

      .search-icon {
        position: absolute;
        left: 18px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray);
        font-size: 1.1rem;
      }

      .cart-btn,
      .user-btn,
      .menu-btn {
        position: relative;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--light);
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: var(--transition);
        font-size: 1.1rem;
      }

      .cart-btn:hover,
      .user-btn:hover,
      .menu-btn:hover {
        background: rgba(139, 92, 246, 0.2);
        border-color: var(--primary);
        transform: translateY(-2px);
      }

      .cart-count {
        position: absolute;
        top: -8px;
        right: -8px;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        color: white;
        font-size: 0.7rem;
        font-weight: 600;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: bounce 2s infinite;
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-5px);
        }
        60% {
          transform: translateY(-3px);
        }
      }

      /* Mobile Menu Button */
      .menu-btn {
        display: none;
      }

      /* Main Container */
      .main-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
        opacity: 0;
        animation: fadeInUp 1s forwards 0.5s;
      }

      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Filters Section */
      .filters-section {
        background: rgba(30, 41, 59, 0.6);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 3rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: var(--shadow);
      }

      .filters-title {
        font-family: "Playfair Display", serif;
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        color: var(--light);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .filters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        align-items: end;
      }

      .filter-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .filter-label {
        color: var(--gray);
        font-size: 0.9rem;
        font-weight: 500;
      }

      .filter-select,
      .filter-input {
        padding: 12px 15px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        color: var(--light);
        font-size: 0.9rem;
        transition: var(--transition);
      }

      .filter-select:focus,
      .filter-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
      }

      .filter-btn {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .filter-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
      }

      /* Products Grid */
      .products-section {
        margin-bottom: 3rem;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
      }

      .section-title {
        font-family: "Playfair Display", serif;
        font-size: 1rem;
        font-weight: 700;
        color: var(--light);
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .view-toggle {
        display: flex;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 4px;
        gap: 4px;
      }

      .view-btn {
        background: transparent;
        border: none;
        color: var(--gray);
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
        transition: var(--transition);
      }

      .view-btn.active {
        background: var(--primary);
        color: white;
      }

      .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 2rem;
        transition: var(--transition);
      }

      .products-grid.list-view {
        grid-template-columns: 1fr;
      }

      /* Product Card */
      .product-card {
        background: rgba(30, 41, 59, 0.6);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
        position: relative;
        cursor: pointer;
        animation: slideInUp 0.6s ease-out;
      }

      .product-card:hover {
        transform: translateY(-10px);
        box-shadow: var(--shadow-lg);
        border-color: rgba(139, 92, 246, 0.3);
      }

      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .product-image-container {
        position: relative;
        height: 250px;
        overflow: hidden;
      }

      .product-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: var(--transition);
      }

      .product-card:hover .product-image {
        transform: scale(1.1);
      }

      .product-badge {
        position: absolute;
        top: 15px;
        left: 15px;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        color: white;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .product-actions {
        position: absolute;
        top: 15px;
        right: 15px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        opacity: 0;
        transform: translateX(20px);
        transition: var(--transition);
      }

      .product-card:hover .product-actions {
        opacity: 1;
        transform: translateX(0);
      }

      .action-btn {
        width: 40px;
        height: 40px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        color: var(--dark);
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
      }

      .action-btn:hover {
        background: var(--primary);
        color: white;
        transform: scale(1.1);
      }

      .product-content {
        padding: 1.5rem;
      }

      .product-category {
        color: var(--primary);
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 0.5rem;
      }

      .product-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: var(--light);
        margin-bottom: 0.5rem;
        line-height: 1.4;
      }

      .product-description {
        color: var(--gray);
        font-size: 0.9rem;
        line-height: 1.5;
        margin-bottom: 1rem;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .product-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      .product-tag {
        background: rgba(139, 92, 246, 0.2);
        color: var(--primary);
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: 500;
      }

      .product-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .product-price {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gold);
      }

      .add-to-cart-btn {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
      }

      .add-to-cart-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
      }

      /* List View Styles */
      .products-grid.list-view .product-card {
        display: flex;
        height: 200px;
      }

      .products-grid.list-view .product-image-container {
        width: 300px;
        height: 100%;
        flex-shrink: 0;
      }

      .products-grid.list-view .product-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      /* Cart Drawer */
      .cart-drawer {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100vh;
        background: rgba(15, 23, 42, 0.98);
        backdrop-filter: blur(20px);
        border-left: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 2000;
        transition: var(--transition);
        display: flex;
        flex-direction: column;
      }

      .cart-drawer.open {
        right: 0;
      }

      .cart-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1999;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .cart-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .cart-header {
        padding: 2rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .cart-title {
        font-family: "Playfair Display", serif;
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--light);
      }

      .close-cart {
        background: none;
        border: none;
        color: var(--gray);
        font-size: 1.5rem;
        cursor: pointer;
        transition: var(--transition);
      }

      .close-cart:hover {
        color: var(--light);
        transform: rotate(90deg);
      }

      .cart-content {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
      }

      .cart-item {
        display: flex;
        gap: 1rem;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        margin-bottom: 1rem;
        transition: var(--transition);
      }

      .cart-item:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .cart-item-image {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 10px;
      }

      .cart-item-details {
        flex: 1;
      }

      .cart-item-title {
        font-weight: 600;
        color: var(--light);
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
      }

      .cart-item-price {
        color: var(--gold);
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .quantity-controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .quantity-btn {
        width: 30px;
        height: 30px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--light);
        border-radius: 50%;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
      }

      .quantity-btn:hover {
        background: var(--primary);
        border-color: var(--primary);
      }

      .quantity-display {
        color: var(--light);
        font-weight: 600;
        min-width: 30px;
        text-align: center;
      }

      .remove-item {
        background: none;
        border: none;
        color: var(--error);
        cursor: pointer;
        font-size: 1.2rem;
        transition: var(--transition);
      }

      .remove-item:hover {
        transform: scale(1.2);
      }

      .cart-footer {
        padding: 2rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .cart-total {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        font-size: 1.2rem;
        font-weight: 600;
      }

      .total-label {
        color: var(--gray);
      }

      .total-amount {
        color: var(--gold);
        font-size: 1.5rem;
      }

      .checkout-btn {
        width: 100%;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 15px;
        border-radius: 15px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .checkout-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
      }

      .checkout-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      /* Payment Modal */
      .payment-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 3000;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .payment-modal.active {
        opacity: 1;
        visibility: visible;
      }

      .payment-container {
        background: rgba(30, 41, 59, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 3rem;
        max-width: 500px;
        width: 90%;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transform: scale(0.9);
        transition: var(--transition);
      }

      .payment-modal.active .payment-container {
        transform: scale(1);
      }

      .payment-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .payment-title {
        font-family: "Playfair Display", serif;
        font-size: 1.8rem;
        font-weight: 600;
        color: var(--light);
        margin-bottom: 0.5rem;
      }

      .payment-subtitle {
        color: var(--gray);
        font-size: 0.9rem;
      }

      .crypto-info {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .crypto-amount {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }

      .amount-label {
        color: var(--gray);
        font-size: 0.9rem;
      }

      .amount-value {
        color: var(--gold);
        font-size: 1.2rem;
        font-weight: 600;
      }

      .wallet-address {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .address-label {
        color: var(--gray);
        font-size: 0.8rem;
        margin-bottom: 0.5rem;
      }

      .address-value {
        color: var(--light);
        font-family: monospace;
        font-size: 0.9rem;
        word-break: break-all;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
      }

      .copy-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: var(--transition);
      }

      .copy-btn:hover {
        background: var(--primary-dark);
      }

      .payment-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .form-group {
        position: relative;
      }

      .form-label {
        color: var(--gray);
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
        display: block;
      }

      .form-input {
        width: 100%;
        padding: 12px 15px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        color: var(--light);
        font-size: 0.9rem;
        transition: var(--transition);
      }

      .form-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
      }

      .payment-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .cancel-payment {
        flex: 1;
        background: rgba(255, 255, 255, 0.1);
        color: var(--light);
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 12px;
        border-radius: 10px;
        cursor: pointer;
        transition: var(--transition);
      }

      .cancel-payment:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .confirm-payment {
        flex: 2;
        background: linear-gradient(135deg, var(--success), #059669);
        color: white;
        border: none;
        padding: 12px;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
      }

      .confirm-payment:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
      }

      /* Shipping Address Form */
      .shipping-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-top: 1.5rem;
        padding: 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .shipping-title {
        font-family: "Playfair Display", serif;
        font-size: 1.2rem;
        font-weight: 600;
        color: var(--light);
        margin-bottom: 0.5rem;
      }

      .form-row {
        display: flex;
        gap: 1rem;
      }

      .form-row .form-group {
        flex: 1;
      }

      /* Product Detail Modal */
      .product-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 2500;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .product-modal.active {
        opacity: 1;
        visibility: visible;
      }

      .product-modal-container {
        background: rgba(30, 41, 59, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transform: scale(0.9);
        transition: var(--transition);
      }

      .product-modal.active .product-modal-container {
        transform: scale(1);
      }

      .modal-header {
        position: sticky;
        top: 0;
        background: rgba(30, 41, 59, 0.95);
        backdrop-filter: blur(20px);
        padding: 1.5rem 2rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-close {
        background: none;
        border: none;
        color: var(--gray);
        font-size: 1.5rem;
        cursor: pointer;
        transition: var(--transition);
      }

      .modal-close:hover {
        color: var(--light);
        transform: rotate(90deg);
      }

      .modal-content {
        padding: 2rem;
      }

      .product-detail-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
      }

      .product-images {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .main-image {
        width: 100%;
        height: 300px;
        object-fit: cover;
        border-radius: 15px;
      }

      .thumbnail-images {
        display: flex;
        gap: 0.5rem;
        overflow-x: auto;
      }

      .thumbnail {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 8px;
        cursor: pointer;
        opacity: 0.7;
        transition: var(--transition);
        border: 2px solid transparent;
      }

      .thumbnail:hover,
      .thumbnail.active {
        opacity: 1;
        border-color: var(--primary);
      }

      .product-info {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .product-detail-category {
        color: var(--primary);
        font-size: 0.9rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .product-detail-title {
        font-family: "Playfair Display", serif;
        font-size: 1rem;
        font-weight: 700;
        color: var(--light);
        line-height: 1.3;
      }

      .product-detail-price {
        font-size: 2rem;
        font-weight: 700;
        color: var(--gold);
      }

      .product-detail-description {
        color: var(--gray);
        line-height: 1.6;
      }

      .product-variants {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .variant-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .variant-label {
        color: var(--light);
        font-weight: 600;
        font-size: 0.9rem;
      }

      .variant-options {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .variant-option {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--light);
        padding: 8px 16px;
        border-radius: 20px;
        cursor: pointer;
        transition: var(--transition);
        font-size: 0.9rem;
      }

      .variant-option:hover,
      .variant-option.selected {
        background: var(--primary);
        border-color: var(--primary);
      }

      .add-to-cart-section {
        display: flex;
        gap: 1rem;
        align-items: center;
        margin-top: 2rem;
      }

      .quantity-selector {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 5px;
      }

      .quantity-selector .quantity-btn {
        width: 35px;
        height: 35px;
      }

      .quantity-selector .quantity-display {
        min-width: 40px;
        font-size: 1rem;
      }

      .modal-add-to-cart {
        flex: 1;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 15px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .modal-add-to-cart:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
      }

      /* Status Messages */
      .status-message {
        position: fixed;
        top: 100px;
        right: 20px;
        background: linear-gradient(135deg, var(--success), #059669);
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 15px;
        box-shadow: var(--shadow-lg);
        display: flex;
        align-items: center;
        gap: 1rem;
        z-index: 4000;
        transform: translateX(150%);
        transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        max-width: 350px;
      }

      .status-message.show {
        transform: translateX(0);
      }

      .status-message.error {
        background: linear-gradient(135deg, var(--error), #dc2626);
      }

      .status-icon {
        font-size: 1.5rem;
        flex-shrink: 0;
      }

      .status-text h4 {
        margin-bottom: 0.25rem;
        font-weight: 600;
      }

      .status-text p {
        font-size: 0.9rem;
        opacity: 0.9;
      }

      /* Empty States */
      .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        color: var(--gray);
      }

      .empty-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .empty-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: var(--light);
      }

      .empty-description {
        font-size: 1rem;
        line-height: 1.5;
      }

      /* Loading States */
      .loading-spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: var(--primary);
        animation: spin 1s linear infinite;
      }

      /* Responsive Design */
      @media (max-width: 1200px) {
        .main-container {
          padding: 1.5rem;
        }

        .products-grid {
          grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        }
      }

      @media (max-width: 768px) {
        .header-content {
          padding: 0 1rem;
        }

        .search-container {
          display: block;
          width: 200px;
        }

        .menu-btn {
          display: flex;
        }

        .header-actions > .user-btn,
        .header-actions > .cart-btn {
          display: none;
        }

        .main-container {
          padding: 1rem;
        }

        .filters-section {
          overflow-x: auto;
          padding: 1.5rem;
        }

        .filters-grid {
          display: flex;
          flex-wrap: nowrap;
          gap: 1rem;
          padding-bottom: 1rem;
        }

        .filter-group {
          min-width: 200px;
        }

        .section-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .products-grid {
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 1.5rem;
        }

        .products-grid.list-view .product-card {
          flex-direction: column;
          height: auto;
        }

        .products-grid.list-view .product-image-container {
          width: 100%;
          height: 200px;
        }

        .cart-drawer {
          width: 100%;
          right: -100%;
        }

        .product-detail-grid {
          grid-template-columns: 1fr;
        }

        .payment-container {
          padding: 2rem;
        }

        .modal-content {
          padding: 1.5rem;
        }
      }

      @media (max-width: 480px) {
        .brand-name {
          font-size: 1.5rem;
        }

        .search-container {
          width: 150px;
        }

        .products-grid {
          grid-template-columns: 1fr;
        }

        .product-card {
          margin: 0 0.5rem;
        }

        .filters-section {
          padding: 1.5rem;
        }

        .payment-container {
          padding: 1.5rem;
        }

        .payment-actions {
          flex-direction: column;
        }
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(
          135deg,
          var(--primary-dark),
          var(--secondary)
        );
      }

      /* Animations */
      .animate-fade-in {
        animation: fadeIn 0.6s ease-out;
      }

      .animate-slide-up {
        animation: slideUp 0.6s ease-out;
      }

      .animate-bounce {
        animation: bounce 0.6s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Mobile Menu Drawer */
      .mobile-menu {
        position: fixed;
        top: 0;
        left: -300px;
        width: 300px;
        height: 100vh;
        background: rgba(15, 23, 42, 0.98);
        backdrop-filter: blur(20px);
        border-right: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 2000;
        transition: var(--transition);
        display: flex;
        flex-direction: column;
        padding: 2rem;
      }

      .mobile-menu.open {
        left: 0;
      }

      .mobile-menu-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .mobile-menu-items {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .mobile-menu-item {
        color: var(--light);
        text-decoration: none;
        padding: 1rem;
        border-radius: 10px;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .mobile-menu-item:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--primary);
      }

      /* Wishlist Button Styles */
      .wishlist-btn {
        position: relative;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--light);
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: var(--transition);
        font-size: 1.1rem;
      }

      .wishlist-btn:hover {
        background: rgba(244, 63, 94, 0.2);
        border-color: var(--secondary);
        transform: translateY(-2px);
      }

      .wishlist-btn.active {
        background: rgba(244, 63, 94, 0.3);
        border-color: var(--secondary);
        color: var(--secondary);
      }

      .wishlist-count {
        position: absolute;
        top: -8px;
        right: -8px;
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        color: white;
        font-size: 0.7rem;
        font-weight: 600;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: bounce 2s infinite;
      }
    </style>
  </head>
  <body>
    <!-- Luxury Loader -->
    <div class="loader-container" id="loader">
      <div class="loader">
        <div class="loader-ring"></div>
        <div class="loader-ring"></div>
        <div class="loader-ring"></div>
      </div>
      <img
        src="https://cdn-icons-png.flaticon.com/128/10856/10856545.png"
        alt="Fetish Zone Logo"
        class="loader-logo"
      />
      <div class="loader-text">Fetish Zone</div>
      <div class="loader-subtitle">Premium Store</div>
    </div>

    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo-container">
          <img
            src="https://cdn-icons-png.flaticon.com/128/10856/10856545.png"
            alt="Fetish Zone Logo"
            class="logo"
          />
          <!-- <h1 class="brand-name">Fetish Zone</h1> -->
        </div>

        <div class="header-actions">
          <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input
              type="text"
              class="search-input"
              id="searchInput"
              placeholder="Search products..."
            />
          </div>

          <button class="cart-btn" id="cartBtn">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-count" id="cartCount">0</span>
          </button>

          <button class="user-btn" id="userBtn">
            <i class="fas fa-user"></i>
          </button>

          <button class="menu-btn" id="menuBtn">
            <i class="fas fa-bars"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
      <div class="mobile-menu-header">
        <h3>Menu</h3>
        <button class="modal-close" id="closeMobileMenu">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="mobile-menu-items">
        <a href="#" class="mobile-menu-item">
          <i class="fas fa-search"></i>
          Search
        </a>
        <a href="/cart/" class="mobile-menu-item">
          <i class="fas fa-shopping-cart"></i>
          Cart (<span id="mobileCartCount">0</span>)
        </a>
        <a href="/profile/" class="mobile-menu-item">
          <i class="fas fa-user"></i>
          Profile
        </a>
        <a href="/wishlist/" class="mobile-menu-item">
          <i class="fas fa-heart"></i>
          Wishlist
        </a>
        <a href="/orderhistory/" class="mobile-menu-item">
          <i class="fas fa-history"></i>
          Order History
        </a>
        <a href="/login/" class="mobile-menu-item">
          <i class="fas fa-sign-out-alt"></i>
          Logout
        </a>
      </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
      <!-- Filters Section -->
      <section class="filters-section animate-slide-up">
        <h2 class="filters-title">
          <i class="fas fa-filter"></i>
          Filter Products
        </h2>
        <div class="filters-grid">
          <div class="filter-group">
            <label class="filter-label">Category</label>
            <select class="filter-select" id="categoryFilter">
              <option value="">All Categories</option>
            </select>
          </div>
          <div class="filter-group">
            <label class="filter-label">Price Range</label>
            <select class="filter-select" id="priceFilter">
              <option value="">All Prices</option>
              <option value="0-50">$0 - $50</option>
              <option value="50-100">$50 - $100</option>
              <option value="100-200">$100 - $200</option>
              <option value="200+">$200+</option>
            </select>
          </div>
          <div class="filter-group">
            <label class="filter-label">Sort By</label>
            <select class="filter-select" id="sortFilter">
              <option value="newest">Newest First</option>
              <option value="price-low">Price: Low to High</option>
              <option value="price-high">Price: High to Low</option>
              <option value="name">Name A-Z</option>
            </select>
          </div>
          <div class="filter-group">
            <button class="filter-btn" id="applyFilters">
              <i class="fas fa-check"></i>
              Apply Filters
            </button>
          </div>
        </div>
      </section>

      <!-- Products Section -->
      <section class="products-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-gem"></i>
            Premium Collection
          </h2>
          <div class="view-toggle">
            <button class="view-btn active" id="gridViewBtn">
              <i class="fas fa-th"></i>
            </button>
            <button class="view-btn" id="listViewBtn">
              <i class="fas fa-list"></i>
            </button>
          </div>
        </div>

        <div class="products-grid" id="productsGrid">
          <!-- Products will be loaded here -->
          <div class="empty-state" id="loadingState">
            <div class="loading-spinner"></div>
            <h3 class="empty-title">Loading Products...</h3>
            <p class="empty-description">
              Please wait while we fetch the latest products for you.
            </p>
          </div>
        </div>
      </section>
    </div>

    <!-- Cart Drawer -->
    <div class="cart-overlay" id="cartOverlay"></div>
    <div class="cart-drawer" id="cartDrawer">
      <div class="cart-header">
        <h3 class="cart-title">Shopping Cart</h3>
        <button class="close-cart" id="closeCart">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="cart-content" id="cartContent">
        <div class="empty-state">
          <i class="fas fa-shopping-cart empty-icon"></i>
          <h3 class="empty-title">Your cart is empty</h3>
          <p class="empty-description">Add some products to get started!</p>
        </div>
      </div>

      <div class="cart-footer" id="cartFooter" style="display: none">
        <div class="cart-total">
          <span class="total-label">Total:</span>
          <span class="total-amount" id="cartTotal">$0.00</span>
        </div>
        <button class="checkout-btn" id="checkoutBtn">
          <i class="fas fa-credit-card"></i>
          Proceed to Checkout
        </button>
      </div>
    </div>

    <!-- Product Detail Modal -->
    <div class="product-modal" id="productModal">
      <div class="product-modal-container">
        <div class="modal-header">
          <h3>Product Details</h3>
          <button class="modal-close" id="closeProductModal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-content" id="productModalContent">
          <!-- Product details will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Payment Modal -->
    <div class="payment-modal" id="paymentModal">
      <div class="payment-container">
        <div class="payment-header">
          <h3 class="payment-title">Crypto Payment</h3>
          <p class="payment-subtitle">Complete your purchase with USDT</p>
        </div>

        <div class="crypto-info">
          <div class="crypto-amount">
            <span class="amount-label">Total Amount (USD):</span>
            <span class="amount-value" id="paymentAmountUSD">$0.00</span>
          </div>
          <div class="crypto-amount">
            <span class="amount-label">Amount in USDT:</span>
            <span class="amount-value" id="paymentAmountUSDT">0.00 USDT</span>
          </div>

          <div class="wallet-address">
            <div class="address-label">Send USDT to this address:</div>
            <div class="address-value">
              <span id="walletAddress">TQn9Y2khEsLJW1ChVWFMSMeRDow5KcbLSE</span>
              <button class="copy-btn" id="copyAddressBtn">Copy</button>
            </div>
          </div>
        </div>

        <form class="payment-form" id="paymentForm">
          <div class="shipping-form">
            <h4 class="shipping-title">Shipping Information</h4>

            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Full Name</label>
                <input
                  type="text"
                  class="form-input"
                  id="shippingName"
                  placeholder="Enter full name"
                  required
                />
              </div>

              <div class="form-group">
                <label class="form-label">Phone Number</label>
                <input
                  type="tel"
                  class="form-input"
                  id="shippingPhone"
                  placeholder="Enter phone number"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Address</label>
              <input
                type="text"
                class="form-input"
                id="shippingAddress"
                placeholder="Street address"
                required
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label class="form-label">City</label>
                <input
                  type="text"
                  class="form-input"
                  id="shippingCity"
                  placeholder="Enter city"
                  required
                />
              </div>

              <div class="form-group">
                <label class="form-label">State/Region</label>
                <input
                  type="text"
                  class="form-input"
                  id="shippingState"
                  placeholder="Enter state/region"
                  required
                />
              </div>

              <div class="form-group">
                <label class="form-label">Postal Code</label>
                <input
                  type="text"
                  class="form-input"
                  id="shippingPostalCode"
                  placeholder="Enter postal code"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Country</label>
              <select class="form-input" id="shippingCountry" required>
                <option value="">Select Country</option>
                <option value="US">United States</option>
                <option value="UK">United Kingdom</option>
                <option value="CA">Canada</option>
                <option value="AU">Australia</option>
                <!-- Add more countries as needed -->
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Delivery Instructions (Optional)</label>
              <textarea
                class="form-input"
                id="deliveryInstructions"
                placeholder="Any special delivery instructions..."
                rows="2"
              ></textarea>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Transaction Hash</label>
            <input
              type="text"
              class="form-input"
              id="transactionHash"
              placeholder="Enter transaction hash"
              required
            />
          </div>

          <div class="form-group">
            <label class="form-label">Your Email</label>
            <input
              type="email"
              class="form-input"
              id="paymentEmail"
              placeholder="Enter your email"
              required
            />
          </div>

          <div class="form-group">
            <label class="form-label">Additional Notes (Optional)</label>
            <textarea
              class="form-input"
              id="paymentNotes"
              placeholder="Any additional information..."
              rows="3"
            ></textarea>
          </div>

          <div class="payment-actions">
            <button type="button" class="cancel-payment" id="cancelPayment">
              Cancel
            </button>
            <button type="submit" class="confirm-payment" id="confirmPayment">
              <i class="fas fa-check"></i>
              Confirm Payment
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Status Messages -->
    <div class="status-message" id="statusMessage">
      <i class="fas fa-check-circle status-icon"></i>
      <div class="status-text">
        <h4 id="statusTitle">Success!</h4>
        <p id="statusDescription">Operation completed successfully</p>
      </div>
    </div>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBNtrsRJoq82G4vSJnNLtcuIgGNMQu7dsw",
        authDomain: "ecommerce-79bf2.firebaseapp.com",
        databaseURL: "https://ecommerce-79bf2-default-rtdb.firebaseio.com/",
        projectId: "ecommerce-79bf2",
        storageBucket: "ecommerce-79bf2.appspot.com",
        messagingSenderId: "420163739618",
        appId: "1:420163739618:android:45d0da5b4acf0fff9663bb",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();
      const auth = firebase.auth();

      // Global variables
      let products = [];
      let filteredProducts = [];
      let cart = JSON.parse(localStorage.getItem("fetishZoneCart")) || [];
      let categories = new Set();
      let currentUser = null;

      // USDT exchange rate (you can fetch this from an API)
      const USDT_RATE = 1.0; // 1 USD = 1 USDT (approximately)

      // DOM Elements
      const loader = document.getElementById("loader");
      const searchInput = document.getElementById("searchInput");
      const categoryFilter = document.getElementById("categoryFilter");
      const priceFilter = document.getElementById("priceFilter");
      const sortFilter = document.getElementById("sortFilter");
      const applyFiltersBtn = document.getElementById("applyFilters");
      const productsGrid = document.getElementById("productsGrid");
      const gridViewBtn = document.getElementById("gridViewBtn");
      const listViewBtn = document.getElementById("listViewBtn");
      const cartBtn = document.getElementById("cartBtn");
      const cartCount = document.getElementById("cartCount");
      const mobileCartCount = document.getElementById("mobileCartCount");
      const cartDrawer = document.getElementById("cartDrawer");
      const cartOverlay = document.getElementById("cartOverlay");
      const closeCart = document.getElementById("closeCart");
      const cartContent = document.getElementById("cartContent");
      const cartFooter = document.getElementById("cartFooter");
      const cartTotal = document.getElementById("cartTotal");
      const checkoutBtn = document.getElementById("checkoutBtn");
      const productModal = document.getElementById("productModal");
      const closeProductModal = document.getElementById("closeProductModal");
      const productModalContent = document.getElementById(
        "productModalContent"
      );
      const paymentModal = document.getElementById("paymentModal");
      const paymentForm = document.getElementById("paymentForm");
      const cancelPayment = document.getElementById("cancelPayment");
      const confirmPayment = document.getElementById("confirmPayment");
      const copyAddressBtn = document.getElementById("copyAddressBtn");
      const statusMessage = document.getElementById("statusMessage");
      const statusTitle = document.getElementById("statusTitle");
      const statusDescription = document.getElementById("statusDescription");
      const menuBtn = document.getElementById("menuBtn");
      const mobileMenu = document.getElementById("mobileMenu");
      const closeMobileMenu = document.getElementById("closeMobileMenu");

      // Initialize the application
      document.addEventListener("DOMContentLoaded", () => {
        initializeApp();
      });

      async function initializeApp() {
        // Hide loader after 2 seconds
        setTimeout(() => {
          loader.classList.add("hidden");
        }, 2000);

        // Check authentication
        auth.onAuthStateChanged((user) => {
          currentUser = user;
          if (!user) {
            // Redirect to login if not authenticated
            window.location.href = "/signup/";
          }
        });

        // Load products
        await loadProducts();

        // Setup event listeners
        setupEventListeners();

        // Update cart display
        updateCartDisplay();
      }

      function setupEventListeners() {
        // Search
        searchInput.addEventListener("input", debounce(handleSearch, 300));

        // Filters
        applyFiltersBtn.addEventListener("click", applyFilters);
        categoryFilter.addEventListener("change", applyFilters);
        priceFilter.addEventListener("change", applyFilters);
        sortFilter.addEventListener("change", applyFilters);

        // View toggle
        gridViewBtn.addEventListener("click", () => setView("grid"));
        listViewBtn.addEventListener("click", () => setView("list"));

        // Cart
        cartBtn.addEventListener("click", toggleCart);
        closeCart.addEventListener("click", toggleCart);
        cartOverlay.addEventListener("click", toggleCart);
        checkoutBtn.addEventListener("click", openPaymentModal);

        // Product modal
        closeProductModal.addEventListener("click", closeProductDetailModal);

        // Payment modal
        cancelPayment.addEventListener("click", closePaymentModal);
        paymentForm.addEventListener("submit", handlePaymentSubmission);
        copyAddressBtn.addEventListener("click", copyWalletAddress);

        // Mobile menu
        menuBtn.addEventListener("click", toggleMobileMenu);
        closeMobileMenu.addEventListener("click", toggleMobileMenu);

        // Close modals on escape key
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            closeProductDetailModal();
            closePaymentModal();
            if (cartDrawer.classList.contains("open")) {
              toggleCart();
            }
            if (mobileMenu.classList.contains("open")) {
              toggleMobileMenu();
            }
          }
        });
      }

      // Debounce function for search
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Load products from Firebase
      async function loadProducts() {
        try {
          const snapshot = await database.ref("products").once("value");
          products = [];
          categories.clear();

          snapshot.forEach((childSnapshot) => {
            const product = {
              id: childSnapshot.key,
              ...childSnapshot.val(),
            };
            products.push(product);
            categories.add(product.category);
          });

          filteredProducts = [...products];
          populateCategoryFilter();
          renderProducts();
        } catch (error) {
          console.error("Error loading products:", error);
          showStatus(
            "error",
            "Error Loading Products",
            "Failed to load products. Please refresh the page."
          );
        }
      }

      // Populate category filter dropdown
      function populateCategoryFilter() {
        categoryFilter.innerHTML = '<option value="">All Categories</option>';
        categories.forEach((category) => {
          const option = document.createElement("option");
          option.value = category;
          option.textContent = category;
          categoryFilter.appendChild(option);
        });
      }

      // Handle search
      function handleSearch() {
        applyFilters();
      }

      // Apply filters
      function applyFilters() {
        const searchTerm = searchInput.value.toLowerCase();
        const selectedCategory = categoryFilter.value;
        const selectedPriceRange = priceFilter.value;
        const sortBy = sortFilter.value;

        filteredProducts = products.filter((product) => {
          // Search filter
          const matchesSearch =
            !searchTerm ||
            product.title.toLowerCase().includes(searchTerm) ||
            product.description.toLowerCase().includes(searchTerm) ||
            product.category.toLowerCase().includes(searchTerm) ||
            (product.tags &&
              product.tags.some((tag) =>
                tag.toLowerCase().includes(searchTerm)
              ));

          // Category filter
          const matchesCategory =
            !selectedCategory || product.category === selectedCategory;

          // Price filter
          let matchesPrice = true;
          if (selectedPriceRange) {
            const price = product.price;
            switch (selectedPriceRange) {
              case "0-50":
                matchesPrice = price >= 0 && price <= 50;
                break;
              case "50-100":
                matchesPrice = price > 50 && price <= 100;
                break;
              case "100-200":
                matchesPrice = price > 100 && price <= 200;
                break;
              case "200+":
                matchesPrice = price > 200;
                break;
            }
          }

          return matchesSearch && matchesCategory && matchesPrice;
        });

        // Sort products
        switch (sortBy) {
          case "price-low":
            filteredProducts.sort((a, b) => a.price - b.price);
            break;
          case "price-high":
            filteredProducts.sort((a, b) => b.price - a.price);
            break;
          case "name":
            filteredProducts.sort((a, b) => a.title.localeCompare(b.title));
            break;
          case "newest":
          default:
            filteredProducts.sort(
              (a, b) => (b.createdAt || 0) - (a.createdAt || 0)
            );
            break;
        }

        renderProducts();
      }

      // Set view mode
      function setView(viewMode) {
        if (viewMode === "grid") {
          productsGrid.classList.remove("list-view");
          gridViewBtn.classList.add("active");
          listViewBtn.classList.remove("active");
        } else {
          productsGrid.classList.add("list-view");
          listViewBtn.classList.add("active");
          gridViewBtn.classList.remove("active");
        }
      }

      // Render products
      function renderProducts() {
        if (filteredProducts.length === 0) {
          productsGrid.innerHTML = `
                  <div class="empty-state">
                      <i class="fas fa-search empty-icon"></i>
                      <h3 class="empty-title">No products found</h3>
                      <p class="empty-description">Try adjusting your search or filter criteria.</p>
                  </div>
              `;
          return;
        }

        productsGrid.innerHTML = "";

        filteredProducts.forEach((product, index) => {
          const productCard = createProductCard(product, index);
          productsGrid.appendChild(productCard);
        });
      }

      // Create product card
      function createProductCard(product, index) {
        const card = document.createElement("div");
        card.className = "product-card animate-slide-up";
        card.style.animationDelay = `${index * 0.1}s`;

        const hasDiscount =
          product.originalPrice && product.originalPrice > product.price;
        const discountPercent = hasDiscount
          ? Math.round(
              ((product.originalPrice - product.price) /
                product.originalPrice) *
                100
            )
          : 0;

        card.innerHTML = `
              <div class="product-image-container">
                  <img src="${product.mainImage}" alt="${
          product.title
        }" class="product-image"
                       onerror="this.src='https://via.placeholder.com/300x250?text=No+Image'">
                  ${
                    hasDiscount
                      ? `<div class="product-badge">-${discountPercent}%</div>`
                      : ""
                  }
                  ${
                    product.stock <= 0
                      ? '<div class="product-badge" style="background: var(--error);">Out of Stock</div>'
                      : ""
                  }
                  <div class="product-actions">
                      <button class="action-btn" onclick="toggleWishlist('${
                        product.id
                      }')" title="Add to Wishlist">
                          <i class="fas fa-heart"></i>
                      </button>
                      <button class="action-btn" onclick="quickView('${
                        product.id
                      }')" title="Quick View">
                          <i class="fas fa-eye"></i>
                      </button>
                      <button class="action-btn" onclick="shareProduct('${
                        product.id
                      }')" title="Share">
                          <i class="fas fa-share-alt"></i>
                      </button>
                  </div>
              </div>
              <div class="product-content">
                  <div class="product-category">${product.category}</div>
                  <h3 class="product-title">${product.title}</h3>
                  <p class="product-description">${product.description}</p>
                  ${
                    product.tags
                      ? `
                      <div class="product-tags">
                          ${product.tags
                            .slice(0, 3)
                            .map(
                              (tag) => `<span class="product-tag">${tag}</span>`
                            )
                            .join("")}
                      </div>
                  `
                      : ""
                  }
                  <div class="product-footer">
                      <div class="product-price">
                          $${product.price.toFixed(2)}
                          ${
                            hasDiscount
                              ? `<span style="text-decoration: line-through; color: var(--gray); font-size: 0.9rem; margin-left: 0.5rem;">$${product.originalPrice.toFixed(
                                  2
                                )}</span>`
                              : ""
                          }
                      </div>
                      <button class="add-to-cart-btn" onclick="addToCart('${
                        product.id
                      }')" ${product.stock <= 0 ? "disabled" : ""}>
                          <i class="fas fa-shopping-cart"></i>
                          ${product.stock <= 0 ? "Out of Stock" : "Add to Cart"}
                      </button>
                  </div>
              </div>
          `;

        // Add click event to open product detail
        card.addEventListener("click", (e) => {
          if (
            !e.target.closest(".product-actions") &&
            !e.target.closest(".add-to-cart-btn")
          ) {
            openProductDetail(product.id);
          }
        });

        return card;
      }

      // Add to cart
      function addToCart(productId, quantity = 1) {
        const product = products.find((p) => p.id === productId);
        if (!product || product.stock <= 0) {
          showStatus(
            "error",
            "Out of Stock",
            "This product is currently out of stock."
          );
          return;
        }

        const existingItem = cart.find((item) => item.id === productId);

        if (existingItem) {
          if (existingItem.quantity + quantity <= product.stock) {
            existingItem.quantity += quantity;
          } else {
            showStatus(
              "error",
              "Stock Limit",
              `Only ${product.stock} items available in stock.`
            );
            return;
          }
        } else {
          cart.push({
            id: productId,
            title: product.title,
            price: product.price,
            image: product.mainImage,
            quantity: quantity,
            maxStock: product.stock,
          });
        }

        localStorage.setItem("fetishZoneCart", JSON.stringify(cart));
        updateCartDisplay();
        showStatus(
          "success",
          "Added to Cart",
          `${product.title} has been added to your cart.`
        );
      }

      // Remove from cart
      function removeFromCart(productId) {
        cart = cart.filter((item) => item.id !== productId);
        localStorage.setItem("fetishZoneCart", JSON.stringify(cart));
        updateCartDisplay();
        renderCartItems();
      }

      // Update cart quantity
      function updateCartQuantity(productId, newQuantity) {
        const item = cart.find((item) => item.id === productId);
        if (!item) return;

        if (newQuantity <= 0) {
          removeFromCart(productId);
          return;
        }

        if (newQuantity > item.maxStock) {
          showStatus(
            "error",
            "Stock Limit",
            `Only ${item.maxStock} items available in stock.`
          );
          return;
        }

        item.quantity = newQuantity;
        localStorage.setItem("fetishZoneCart", JSON.stringify(cart));
        updateCartDisplay();
        renderCartItems();
      }

      // Update cart display
      function updateCartDisplay() {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;
        mobileCartCount.textContent = totalItems;

        if (totalItems > 0) {
          cartCount.style.display = "flex";
        } else {
          cartCount.style.display = "none";
        }
      }

      // Toggle cart drawer
      function toggleCart() {
        const isOpen = cartDrawer.classList.contains("open");

        if (isOpen) {
          cartDrawer.classList.remove("open");
          cartOverlay.classList.remove("active");
        } else {
          cartDrawer.classList.add("open");
          cartOverlay.classList.add("active");
          renderCartItems();
        }
      }

      // Render cart items
      function renderCartItems() {
        if (cart.length === 0) {
          cartContent.innerHTML = `
                  <div class="empty-state">
                      <i class="fas fa-shopping-cart empty-icon"></i>
                      <h3 class="empty-title">Your cart is empty</h3>
                      <p class="empty-description">Add some products to get started!</p>
                  </div>
              `;
          cartFooter.style.display = "none";
          return;
        }

        cartContent.innerHTML = "";
        let total = 0;

        cart.forEach((item) => {
          total += item.price * item.quantity;

          const cartItem = document.createElement("div");
          cartItem.className = "cart-item animate-fade-in";
          cartItem.innerHTML = `
                  <img src="${item.image}" alt="${
            item.title
          }" class="cart-item-image"
                       onerror="this.src='https://via.placeholder.com/80x80?text=No+Image'">
                  <div class="cart-item-details">
                      <h4 class="cart-item-title">${item.title}</h4>
                      <div class="cart-item-price">$${item.price.toFixed(
                        2
                      )}</div>
                      <div class="quantity-controls">
                          <button class="quantity-btn" onclick="updateCartQuantity('${
                            item.id
                          }', ${item.quantity - 1})">
                              <i class="fas fa-minus"></i>
                          </button>
                          <span class="quantity-display">${item.quantity}</span>
                          <button class="quantity-btn" onclick="updateCartQuantity('${
                            item.id
                          }', ${item.quantity + 1})">
                              <i class="fas fa-plus"></i>
                          </button>
                      </div>
                  </div>
                  <button class="remove-item" onclick="removeFromCart('${
                    item.id
                  }')" title="Remove item">
                      <i class="fas fa-trash"></i>
                  </button>
              `;
          cartContent.appendChild(cartItem);
        });

        cartTotal.textContent = `$${total.toFixed(2)}`;
        cartFooter.style.display = "block";
      }

      // Open product detail modal
      function openProductDetail(productId) {
        const product = products.find((p) => p.id === productId);
        if (!product) return;

        const allImages = [
          product.mainImage,
          ...(product.additionalImages || []),
        ].filter(Boolean);

        productModalContent.innerHTML = `
              <div class="product-detail-grid">
                  <div class="product-images">
                      <img src="${allImages[0]}" alt="${
          product.title
        }" class="main-image" id="mainDetailImage"
                           onerror="this.src='https://via.placeholder.com/400x300?text=No+Image'">
                      ${
                        allImages.length > 1
                          ? `
                          <div class="thumbnail-images">
                              ${allImages
                                .map(
                                  (img, index) => `
                                  <img src="${img}" alt="Thumbnail ${
                                    index + 1
                                  }" class="thumbnail ${
                                    index === 0 ? "active" : ""
                                  }"
                                       onclick="changeMainImage('${img}', this)"
                                       onerror="this.src='https://via.placeholder.com/60x60?text=No+Image'">
                              `
                                )
                                .join("")}
                          </div>
                      `
                          : ""
                      }
                  </div>
                  <div class="product-info">
                      <div class="product-detail-category">${
                        product.category
                      }</div>
                      <h2 class="product-detail-title">${product.title}</h2>
                      <div class="product-detail-price">$${product.price.toFixed(
                        2
                      )}</div>
                      <p class="product-detail-description">${
                        product.description
                      }</p>

                      ${
                        product.tags
                          ? `
                          <div class="product-tags">
                              ${product.tags
                                .map(
                                  (tag) =>
                                    `<span class="product-tag">${tag}</span>`
                                )
                                .join("")}
                          </div>
                      `
                          : ""
                      }

                      ${
                        product.variants && product.variants.length > 0
                          ? `
                          <div class="product-variants">
                              ${product.variants
                                .map(
                                  (variant) => `
                                  <div class="variant-group">
                                      <div class="variant-label">${variant.name}:</div>
                                      <div class="variant-options">
                                          <div class="variant-option selected">${variant.value}</div>
                                      </div>
                                  </div>
                              `
                                )
                                .join("")}
                          </div>
                      `
                          : ""
                      }

                      <div class="add-to-cart-section">
                          <div class="quantity-selector">
                              <button class="quantity-btn" onclick="changeModalQuantity(-1)">
                                  <i class="fas fa-minus"></i>
                              </button>
                              <span class="quantity-display" id="modalQuantity">1</span>
                              <button class="quantity-btn" onclick="changeModalQuantity(1)">
                                  <i class="fas fa-plus"></i>
                              </button>
                          </div>
                          <button class="modal-add-to-cart" onclick="addToCartFromModal('${
                            product.id
                          }')" ${product.stock <= 0 ? "disabled" : ""}>
                              <i class="fas fa-shopping-cart"></i>
                              ${product.stock <= 0 ? "Out of Stock" : "Add"}
                          </button>
                      </div>

                      <div style="margin-top: 1rem; color: var(--gray); font-size: 0.9rem;">
                          <i class="fas fa-box"></i> Stock: ${
                            product.stock
                          } available
                      </div>
                  </div>
              </div>
          `;

        productModal.classList.add("active");
      }

      // Close product detail modal
      function closeProductDetailModal() {
        productModal.classList.remove("active");
      }

      // Change main image in product detail
      function changeMainImage(imageSrc, thumbnail) {
        document.getElementById("mainDetailImage").src = imageSrc;
        document
          .querySelectorAll(".thumbnail")
          .forEach((thumb) => thumb.classList.remove("active"));
        thumbnail.classList.add("active");
      }

      // Change modal quantity
      function changeModalQuantity(change) {
        const quantityDisplay = document.getElementById("modalQuantity");
        let currentQuantity = parseInt(quantityDisplay.textContent);
        const newQuantity = Math.max(1, currentQuantity + change);
        quantityDisplay.textContent = newQuantity;
      }

      // Add to cart from modal
      function addToCartFromModal(productId) {
        const quantity = parseInt(
          document.getElementById("modalQuantity").textContent
        );
        addToCart(productId, quantity);
        closeProductDetailModal();
      }

      // Open payment modal
      function openPaymentModal() {
        if (cart.length === 0) {
          showStatus(
            "error",
            "Empty Cart",
            "Your cart is empty. Add some products first."
          );
          return;
        }

        const total = cart.reduce(
          (sum, item) => sum + item.price * item.quantity,
          0
        );
        const usdtAmount = (total * USDT_RATE).toFixed(2);

        document.getElementById(
          "paymentAmountUSD"
        ).textContent = `$${total.toFixed(2)}`;
        document.getElementById(
          "paymentAmountUSDT"
        ).textContent = `${usdtAmount} USDT`;

        // Pre-fill email if user is logged in
        if (currentUser && currentUser.email) {
          document.getElementById("paymentEmail").value = currentUser.email;
        }

        paymentModal.classList.add("active");
        toggleCart(); // Close cart drawer
      }

      // Close payment modal
      function closePaymentModal() {
        paymentModal.classList.remove("active");
        paymentForm.reset();
      }

      // Copy wallet address
      function copyWalletAddress() {
        const walletAddress =
          document.getElementById("walletAddress").textContent;
        navigator.clipboard
          .writeText(walletAddress)
          .then(() => {
            showStatus(
              "success",
              "Copied!",
              "Wallet address copied to clipboard."
            );
          })
          .catch(() => {
            showStatus(
              "error",
              "Copy Failed",
              "Failed to copy wallet address."
            );
          });
      }

      // Handle payment submission
      async function handlePaymentSubmission(e) {
        e.preventDefault();

        const transactionHash = document
          .getElementById("transactionHash")
          .value.trim();
        const email = document.getElementById("paymentEmail").value.trim();
        const notes = document.getElementById("paymentNotes").value.trim();

        // Shipping information
        const shippingName = document
          .getElementById("shippingName")
          .value.trim();
        const shippingPhone = document
          .getElementById("shippingPhone")
          .value.trim();
        const shippingAddress = document
          .getElementById("shippingAddress")
          .value.trim();
        const shippingCity = document
          .getElementById("shippingCity")
          .value.trim();
        const shippingState = document
          .getElementById("shippingState")
          .value.trim();
        const shippingPostalCode = document
          .getElementById("shippingPostalCode")
          .value.trim();
        const shippingCountry =
          document.getElementById("shippingCountry").value;
        const deliveryInstructions = document
          .getElementById("deliveryInstructions")
          .value.trim();

        if (
          !transactionHash ||
          !email ||
          !shippingName ||
          !shippingPhone ||
          !shippingAddress ||
          !shippingCity ||
          !shippingState ||
          !shippingPostalCode ||
          !shippingCountry
        ) {
          showStatus(
            "error",
            "Missing Information",
            "Please fill in all required fields."
          );
          return;
        }

        // Show loading state
        const submitBtn = document.getElementById("confirmPayment");
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML =
          '<i class="fas fa-spinner fa-spin"></i> Processing...';
        submitBtn.disabled = true;

        try {
          // Calculate totals
          const total = cart.reduce(
            (sum, item) => sum + item.price * item.quantity,
            0
          );
          const usdtAmount = (total * USDT_RATE).toFixed(2);

          // Create payment record
          const paymentData = {
            orderId: generateOrderId(),
            userId: currentUser ? currentUser.uid : "guest",
            email: email,
            transactionHash: transactionHash,
            totalUSD: total,
            totalUSDT: parseFloat(usdtAmount),
            items: cart.map((item) => ({
              productId: item.id,
              title: item.title,
              price: item.price,
              quantity: item.quantity,
              subtotal: item.price * item.quantity,
            })),
            shippingInfo: {
              name: shippingName,
              phone: shippingPhone,
              address: shippingAddress,
              city: shippingCity,
              state: shippingState,
              postalCode: shippingPostalCode,
              country: shippingCountry,
              instructions: deliveryInstructions,
            },
            status: "pending",
            notes: notes,
            createdAt: firebase.database.ServerValue.TIMESTAMP,
            walletAddress: document.getElementById("walletAddress").textContent,
          };

          // Save to Firebase
          await database.ref("payments").push(paymentData);

          // Clear cart
          cart = [];
          localStorage.removeItem("fetishZoneCart");
          updateCartDisplay();

          // Close modal
          closePaymentModal();

          // Show success message
          showStatus(
            "success",
            "Payment Submitted!",
            "Your payment has been submitted for verification. You will receive a confirmation email shortly."
          );
        } catch (error) {
          console.error("Error submitting payment:", error);
          showStatus(
            "error",
            "Submission Failed",
            "Failed to submit payment. Please try again."
          );
        } finally {
          // Reset button
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }
      }

      // Generate order ID
      function generateOrderId() {
        return (
          "FZ" +
          Date.now() +
          Math.random().toString(36).substr(2, 5).toUpperCase()
        );
      }

      // Toggle mobile menu
      function toggleMobileMenu() {
        mobileMenu.classList.toggle("open");
      }

      // Quick view function
      function quickView(productId) {
        openProductDetail(productId);
      }

      // Wishlist functions (placeholder)
      //   function toggleWishlist(productId) {
      //     showStatus("success", "Wishlist", "Wishlist feature coming soon!");
      //   }

      // Share product function
      function shareProduct(productId) {
        const product = products.find((p) => p.id === productId);
        if (navigator.share) {
          navigator.share({
            title: product.title,
            text: product.description,
            url: window.location.href,
          });
        } else {
          // Fallback: copy URL to clipboard
          navigator.clipboard.writeText(window.location.href).then(() => {
            showStatus(
              "success",
              "Link Copied",
              "Product link copied to clipboard!"
            );
          });
        }
      }

      // Show status message
      function showStatus(type, title, description) {
        statusTitle.textContent = title;
        statusDescription.textContent = description;

        statusMessage.className = `status-message ${
          type === "error" ? "error" : ""
        }`;
        statusMessage.classList.add("show");

        setTimeout(() => {
          statusMessage.classList.remove("show");
        }, 4000);
      }

      // Smooth scroll to top
      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }

      // dude this a a floating fab stuff
      // dude this a a floating fab stuff
      // dude this a a floating fab stuff
      // dude this a a floating fab stuff
      // dude this a a floating fab stuff
      // dude this a a floating fab stuff
      // dude this a a floating fab stuff
      // dude this a a floating fab stuff

      window.addEventListener("scroll", () => {
        const scrollButton = document.getElementById("scrollToTop");
        const cartCount = document.getElementById("cartCount"); // Get the main cart count element

        if (window.pageYOffset > 300) {
          if (!scrollButton) {
            // Create the button
            const button = document.createElement("button");
            button.id = "scrollToTop";
            button.className = "cart-btn"; // Use the same class as your main cart button
            button.innerHTML = `
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count">${
                  cartCount ? cartCount.textContent : "0"
                }</span>
            `;

            button.addEventListener("click", function () {
              window.location.href = "/cart/";
            });

            button.style.cssText = `
                position: fixed;
                bottom: 30px;
                right: 30px;
                width: 50px;
                height: 50px;
                background: linear-gradient(135deg, var(--primary), var(--secondary));
                color: white;
                border: none;
                border-radius: 50%;
                cursor: pointer;
                z-index: 1000;
                transition: var(--transition);
                box-shadow: var(--shadow);
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 18px;
                gap: 4px;
            `;

            button.addEventListener("mouseenter", () => {
              button.style.transform = "translateY(-5px) scale(1.1)";
            });
            button.addEventListener("mouseleave", () => {
              button.style.transform = "translateY(0) scale(1)";
            });

            document.body.appendChild(button);
          } else if (scrollButton) {
            // Update the count if button already exists
            const mobileCount = scrollButton.querySelector(".cart-count");
            if (mobileCount && cartCount) {
              mobileCount.textContent = cartCount.textContent;
            }
          }
        } else {
          if (scrollButton) {
            scrollButton.remove();
          }
        }
      });

      // Add some sample products if none exist (for demo purposes)
      window.addEventListener("load", async () => {
        setTimeout(async () => {
          if (products.length === 0) {
            console.log("No products found");
            // You can add sample products here for demonstration
          }
        }, 3000);
      });

      // Performance optimization: Lazy loading for images
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.classList.remove("lazy");
            observer.unobserve(img);
          }
        });
      });

      // Apply lazy loading to product images
      function applyLazyLoading() {
        document.querySelectorAll("img[data-src]").forEach((img) => {
          imageObserver.observe(img);
        });
      }

      // Call lazy loading after products are rendered
      const originalRenderProducts = renderProducts;
      renderProducts = function () {
        originalRenderProducts.call(this);
        setTimeout(applyLazyLoading, 100);
      };
    </script>
    <!-- Wishlist Functionality -->
    <script>
      // Wishlist functions
      let wishlist =
        JSON.parse(localStorage.getItem("fetishZoneWishlist")) || [];

      // Toggle item in wishlist
      async function toggleWishlist(productId) {
        try {
          if (!currentUser) {
            showStatus(
              "error",
              "Authentication Required",
              "Please sign in to use the wishlist feature."
            );
            return;
          }

          const isInWishlist = wishlist.includes(productId);

          if (isInWishlist) {
            // Remove from wishlist
            await database
              .ref(`users/${currentUser.uid}/wishlist/${productId}`)
              .remove();
            wishlist = wishlist.filter((id) => id !== productId);
            showStatus(
              "success",
              "Removed from Wishlist",
              "Item has been removed from your wishlist."
            );
          } else {
            // Add to wishlist
            await database
              .ref(`users/${currentUser.uid}/wishlist/${productId}`)
              .set(true);
            wishlist.push(productId);
            showStatus(
              "success",
              "Added to Wishlist",
              "Item has been added to your wishlist."
            );
          }

          localStorage.setItem("fetishZoneWishlist", JSON.stringify(wishlist));
          updateWishlistDisplay();
        } catch (error) {
          console.error("Error toggling wishlist:", error);
          showStatus(
            "error",
            "Wishlist Error",
            "Failed to update wishlist. Please try again."
          );
        }
      }

      // Update wishlist display
      function updateWishlistDisplay() {
        const wishlistBtn = document.getElementById("wishlistBtn");
        const wishlistCountEl = document.getElementById("wishlistCount");
        const mobileWishlistCountEl = document.getElementById(
          "mobileWishlistCount"
        );

        if (wishlistBtn && wishlistCountEl && mobileWishlistCountEl) {
          const count = wishlist.length;
          wishlistCountEl.textContent = count;
          mobileWishlistCountEl.textContent = count;

          if (count > 0) {
            wishlistCountEl.style.display = "flex";
          } else {
            wishlistCountEl.style.display = "none";
          }
        }
      }

      // Load wishlist from Firebase
      async function loadWishlist() {
        if (!currentUser) return;

        try {
          const snapshot = await database
            .ref(`users/${currentUser.uid}/wishlist`)
            .once("value");
          wishlist = [];

          snapshot.forEach((childSnapshot) => {
            wishlist.push(childSnapshot.key);
          });

          localStorage.setItem("fetishZoneWishlist", JSON.stringify(wishlist));
          updateWishlistDisplay();
        } catch (error) {
          console.error("Error loading wishlist:", error);
        }
      }

      // Initialize wishlist button in header
      function initWishlistButton() {
        const wishlistBtn = document.createElement("button");
        wishlistBtn.className = "wishlist-btn";
        wishlistBtn.id = "wishlistBtn";
        wishlistBtn.innerHTML = `
      <i class="fas fa-heart"></i>
      <span class="wishlist-count" id="wishlistCount">0</span>
    `;
        wishlistBtn.addEventListener("click", () => {
          window.location.href = "/wishlist/";
        });

        // Add to mobile menu
        const mobileWishlistItem = document.createElement("a");
        mobileWishlistItem.href = "/wishlist/";
        mobileWishlistItem.className = "mobile-menu-item";
        mobileWishlistItem.innerHTML = `
      <i class="fas fa-heart"></i>
      Wishlist (<span id="mobileWishlistCount">0</span>)
    `;

        // Insert after cart button in header
        const cartBtn = document.getElementById("cartBtn");
        if (cartBtn) {
          cartBtn.insertAdjacentElement("afterend", wishlistBtn);
        }

        // Insert in mobile menu
        const mobileMenuItems = document.querySelector(".mobile-menu-items");
        if (mobileMenuItems) {
          const cartMenuItem =
            mobileMenuItems.querySelector("a[href='/cart/']");
          if (cartMenuItem) {
            cartMenuItem.insertAdjacentElement("afterend", mobileWishlistItem);
          }
        }

        updateWishlistDisplay();
      }

      // Call this after Firebase initialization
      document.addEventListener("DOMContentLoaded", () => {
        // Wait a brief moment to ensure other scripts are loaded
        setTimeout(() => {
          if (typeof auth !== "undefined" && typeof database !== "undefined") {
            auth.onAuthStateChanged((user) => {
              currentUser = user;
              loadWishlist();
              initWishlistButton();
            });
          }
        }, 500);
      });
    </script>
  </body>
</html>
